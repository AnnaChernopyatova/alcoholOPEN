<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link id="theme" rel="stylesheet" href="../bootstrap_quartz.css">
    <!-- <link id="theme" rel="stylesheet" href="../bootstrap_minty.css"> -->
    <style>
        /* .modal-dialog{
            opacity: 5;
        } */
    </style>
</head>

<body>
    <div id="modalToggle2"></div>
    <div class="modal fade" id="exampleModalToggle" aria-hidden="true" aria-labelledby="exampleModalToggleLabel"
        tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalToggleLabel">Регистрация</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-2">
                            <label for="recipient-name" class="col-form-label">Имя:</label>
                            <input type="text" class="form-control" id="name">
                            <div id="nameErr" class="error text-warning mt-1">
                            </div>
                        </div>
                        <div class="mb-2">
                            <label for="recipient-name" class="col-form-label">Адрес электронной почты:</label>
                            <input type="email" class="form-control" id="email">
                            <div id="emailErr" class="error text-warning mt-1">
                            </div>
                        </div>
                        <div class="mb-2">
                            <label for="recipient-name" class="col-form-label">Придумайте пароль:</label>
                            <input type="password" class="form-control" id="password">
                            <div id="passwordErr" class="error text-warning mt-1">
                            </div>
                        </div>
                        <div class="mb-2">
                            <label for="recipient-name" class="col-form-label">Повторите пароль:</label>
                            <input type="password" class="form-control" id="retype_password">
                            <div id="passwordErr2" class="error text-warning mt-1">
                            </div>
                        </div>
                        <div class="input-group mb-2">
                            <div class="input-group-text">
                                <input class="form-check-input mt-0 me-1" type="checkbox" value="" id="policy"
                                    aria-label="Checkbox for following text input">
                                <label for="policy" class="col-form-label text-wrap">Согласие на обработку персональных
                                    данных</label>
                            </div>
                        </div>
                        <div id="policyErr" class="error text-warning mt-1 mb-2"></div>
                        <div class="input-group mb-2">
                            <div class="input-group-text">
                                <input class="form-check-input mt-0 me-1" type="checkbox" value="" id="newsletter">
                                <label for="newsletter" class="col-form-label">Хочу получать рассылку</label>
                                <div id="error" class="error text-warning mt-1">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer" id="modal-footer">
                    <button id="sendBtn" type="button" class="btn btn-primary">Send</button>

                    <!-- <button id="sendBtn2" class="btn btn-primary" data-bs-target="#exampleModalToggle2" data-bs-toggle="modal"
                        data-bs-dismiss="modal">Send</button> -->
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="exampleModalToggle2" aria-hidden="true" aria-labelledby="exampleModalToggleLabel2"
        tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalToggleLabel2">Регистрация</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Спасибо за регистрацию!
                </div>
                <div class="modal-footer">
                    <!-- <button class="btn btn-primary" data-bs-target="#exampleModalToggle" data-bs-toggle="modal"
                        data-bs-dismiss="modal">Перейти в личный кабинет</button> -->
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>



    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="coctailblog.html">
                <h2>КоктейльБлог</h2>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarScroll"
                aria-controls="navbarScroll" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarScroll">
                <ul class="navbar-nav me-auto my-2 my-lg-0 navbar-nav-scroll" style="--bs-scroll-height: 100px;">
                    <li class="nav-item">
                        <a class="nav-link " href="#">Кабинет</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#">Калькулятор</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Личный кабинет</a>
                    </li>

                </ul>
                <form class="d-flex">
                    <input class="form-control me-2" type="search" id="search" placeholder="Поищем коктейли?"
                        aria-label="Search">
                    <button class="btn btn-secondary" type="button" onClick="searchResult()">Искать</button>
                </form>
                <a class="btn btn-secondary mx-2 " data-bs-toggle="modal" href="#exampleModalToggle"
                    role="button">Регистрация</a>
            </div>
        </div>
    </nav>



    <div class="container mt-5 mb-5">
        <div class="row justify-content-center">
            <div class="col-6">
                <h1 class="mb-2 text-center">Калькулятор содержания алкоголя в крови</h1>
                <form id="form" class="form-check needs-validation" onsubmit="return false;">

                    <div class="row justify-content-center mb-2">
                        <div class="col-4">
                            <br />
                            <label class="form-check-label" for="sex">Ваш пол</label>
                        </div>
                        <div class="col-4">
                            <br />Женщина
                            <input class="form-check-input" type="radio" name=sex value="0.6" checked />
                        </div>
                        <div class="col-4">
                            <br />Мужчина
                            <input class="form-check-input" type="radio" name=sex value="0.7" />
                        </div>
                    </div>

                    <div class="mb-2">
                        <label class="form-label" for="weight">Масса тела (кг)</label>
                        <input name="weight" type="number" id="weight" min="40" max="250" required />
                    </div>
                    <div class="mb-2">
                        <label class="form-check-label" for="height">Рост (см)</label>
                        <input name="height" type="number" id="height" min="150" max="250" required />
                    </div>
                    <div class="mb-2">Алкоголь:
                        <select id="drinks" name="drinks">
                            <option name="strength" value="1">Не выбрано</option>
                            <option name="strength" value="5">Пиво</option>
                            <option name="strength" value="12">Вино</option>
                            <option name="strength" value="21">Ликер</option>
                            <option name="strength" value="40">Водка, виски, ром</option>
                        </select>
                    </div>
                    <div class="mb-2">
                        <label class="form-check-label" for="volume">Количество (мл)</label>
                        <input name="volume" type="number" id="volume" required />
                    </div>
                    <div>
                        <button class="btn btn-danger" id="btn" onclick="calc()">Посчитать</button>
                    </div>

                </form>
            </div>



            <div class="col-6 mt-5">
                <div id="result">
                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">#</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- <tr>
                            <th scope="row">Пол</th>
                            <td>-</td>
                        </tr> -->
                            <tr>
                                <th scope="row">Масса тела (кг)</th>
                                <td>-</td>
                            </tr>
                            <tr>
                                <th scope="row">Рост (см)</th>
                                <td>-</td>
                            </tr>
                            <tr>
                                <th scope="row">Крепость алкоголя (%)</th>
                                <td>-</td>
                            </tr>
                            <tr>
                                <th scope="row">Количество выпитого (мл)</th>
                                <td>-</td>
                            </tr>
                            <tr>
                                <th scope="row" class="table-danger">Содержание алкоголя в крови (промилли)</th>
                                <td class="table-danger">-</td>
                            </tr>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous">
    </script>

    <script>
        const calc = () => {
            const weight = document.querySelector('#weight').value;
            const height = document.querySelector('#height').value;
            const volume = document.querySelector('#volume').value;
            const strength = document.querySelector('#drinks option:checked').value;
            const sex = document.querySelector('input[type="radio"]:checked').value;

            //let result = Math.round(volume * (strength*0.01) / (weight * sex));
            let result = +(Math.round(((volume * (strength * 0.01) / (weight * sex))) + "e+2") + "e-2");



            generateTable(weight, height, strength, volume, result);
        }



        const generateTable = (weight, height, strength, volume, result) => {
            document.getElementById('result').innerHTML = `<div>
                <table class="table">
                    <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">#</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th scope="row">Масса тела (кг)</th>
                            <td>${weight}</td>
                        </tr>
                        <tr>
                            <th scope="row">Рост (см)</th>
                            <td>${height}</td>
                        </tr>
                        <tr>
                            <th scope="row">Крепость алкоголя (%)</th>
                            <td>${strength}</td>
                        </tr>
                        <tr>
                            <th scope="row">Количество выпитого (мл)</th>
                            <td>${volume}</td>
                        </tr>
                        <tr>
                            <th class="table-danger" scope="row">Содержание алкоголя в крови (промилли)</th>
                            <td class="table-danger">${result}</td>
                        </tr>
                        </tr>
                    </tbody>
                </table>
            </div>`
        }


        // registration

        let form = {}

        sendBtn.onclick = function (e) {
            e.preventDefault();

            clearErr();

            let result = validateName() & validateEmail() & validatePassword() & validateTerms() & validateNews();

            if (result) {

                //document.getElementById("error").innerHTML = "Спасибо за регистрацию!";

                document.getElementById('modal-footer').innerHTML = '';
                let str = ''
                str += `<button id="sendBtn2" class="btn btn-success" data-bs-target="#exampleModalToggle2" data-bs-toggle="modal"
                        data-bs-dismiss="modal">Success! Send!</button>`
                document.getElementById('modal-footer').innerHTML = str;
            } else {
                document.getElementById('modal-footer').innerHTML = '';
                let err = ''
                err += `<button id="sendBtn2" type="button" class="btn btn-danger">Error! Fix it!</button>`
                document.getElementById('modal-footer').innerHTML = err;

                btn2();
            }
        }

        const btn2 = () => {
            sendBtn2.onclick = function (e) {
                e.preventDefault();

                clearErr();

                let result = validateName() & validateEmail() & validatePassword() & validateTerms() &
                    validateNews();

                if (result) {
                    document.getElementById('modal-footer').innerHTML = '';
                    let str = ''
                    str += `<button id="sendBtn2" class="btn btn-success" data-bs-target="#exampleModalToggle2" data-bs-toggle="modal"
                        data-bs-dismiss="modal">Success! Send!</button>`
                    document.getElementById('modal-footer').innerHTML = str;
                }
            }
        }

        const clearErr = () => {
            document.getElementById("error").innerHTML = '';
            document.getElementById("nameErr").innerHTML = '';
            document.getElementById("emailErr").innerHTML = '';
            document.getElementById("passwordErr").innerHTML = '';
            document.getElementById("passwordErr2").innerHTML = '';
            document.getElementById("policyErr").innerHTML = '';
        }

        function validateName() {
            let name = document.getElementById("name").value;
            if (name === "") {
                document.getElementById("nameErr").innerHTML = "Имя не заполнено.<br>";
                return false;
            } else if (name.length < 2) {
                document.getElementById("nameErr").innerHTML = "Имя должно содержать как минимум 2 символа.<br>";
                return false;
            } else {
                form.name = name;
                return true;
            };
        }

        function validateEmail() {
            let email = document.getElementById("email").value;
            let emailFormat = /^[A-Z0-9._%+-]+@[A-Z0-9-]+.+.[A-Z]{2,4}$/i;
            if (email === "") {
                document.getElementById("emailErr").innerHTML = "Адрес электронной почты не заполнен.<br>";
                return false;
            } else if (email.match(emailFormat)) {
                form.email = email;
                return true;
            } else {
                document.getElementById("emailErr").innerHTML = "Адрес электронной почты недействителен.<br>";
                return false;
            }
        }

        function validatePassword() {
            let password = document.getElementById("password").value;
            let retype = document.getElementById("retype_password").value;
            let passwordFormat = /^((?=\S*?[A-Z])(?=\S*?[a-z])(?=\S*?[0-9]).{6,})\S$/;
            if (password === "") {
                document.getElementById("passwordErr").innerHTML = "Пароль не заполнен.<br>";
                return false;
            } else if (password.match(passwordFormat)) {
                if (password !== retype) {
                    document.getElementById("passwordErr2").innerHTML = "Пароли не совпадают.<br>";
                    return false;
                } else {
                    form.password = password;
                    return true;
                };
            } else {
                document.getElementById("passwordErr").innerHTML =
                    "Пароль должен быть на английском языке и состоять как минимум из 6 символов, 1 заглавной буквы, 1 строчной и 1 цифре без пробелов.<br>";
                return false;
            }
        }

        function validateTerms() {
            let terms = document.getElementById("policy");
            if (!terms.checked) {
                document.getElementById("policyErr").innerHTML =
                    "Примите Пользовательское соглашение для регистрации.<br>";
                return false;
            } else {
                form.terms = terms.checked;
                return true;
            };
        }

        function validateNews() {
            let newsletter = document.getElementById("newsletter");
            form.newsletter = newsletter.checked;
            return true;
        }
    </script>
</body>

</html>